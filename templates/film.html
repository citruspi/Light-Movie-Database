<!doctype html>
<html class="no-js" lang="en">

    <head>
    
        {% include 'header.html' %}

        <style>

            body {

                margin-top: 2em;            

            }

            .orbit-timer,
            .orbit-slide-number {
                display: none;
            }

        </style>

    </head>

    <body>
    
        {% include 'menu.html' %}

        <div class="content">
            <!-- Film View -->
        </div>

        {% include 'scripts.html' %}

        <script type="text/javascript">

            var Film = Backbone.Model.extend({
                urlRoot : '/film',
                id: window.location.pathname.split('/')[2]
            });

            var FilmView = Backbone.View.extend({

                el: '.content',

                initialize: function() {
                    this.render();
                },

                render: function() {
                   var html = _.template($('#film-view-template').html(), this.model.toJSON());
                   this.$el.html(html);
                }

            });

            $(function() {

                var film = new Film();

                film.fetch({
                    type: 'POST',
                    success: function(model, response){

                        new FilmView({model: film});

                    },
                    error: function(response, options) {
                        alert("Something went wrong :/");
                    }
                });
            });

        </script>

        <script type="text/template" id="film-view-template">
        <div class="row" style="margin-bottom:2em;">

            <div class="large-3 columns">

                <a class="th" href="#"> 
                    <img src="<%= poster_path %>">
                </a>

                <br><br><br>          

                <table width="100%">

                    <tbody>
                    
                        <tr>

                            <td><strong>Status</strong></td>
                            <td><%= status %></td>

                        </tr>

                        <tr>

                            <td><strong>Runtime</strong></td>
                            <td id="runtime"><%= runtime %> min</td>

                        </tr>  

                        <tr>

                            <td><strong>Release Date</strong></td>
                            <td id="release_date"><%= release_date %></td>

                        </tr>   

                        <tr>

                            <td><strong>Budge (USD)</strong></td>
                            <td id="release_date"><%= budget %></td>

                        </tr>   

                        <tr>

                            <td><strong>Revenue (USD)</strong></td>
                            <td id="release_date"><%= revenue %></td>

                        </tr>                                                                                                

                    </tbody>

                </table>                

            </div>

            <div class="large-9 columns">

                <h2><%= title %></h2>
                <h4 class="subheader"><%= tagline %></h4>

                <br>

                <h5 class="subheader" id="overview">Overview</h4>

                <hr>

                <p><%= overview %></p>

                <h5 class="subheader" id="cast">Cast</h5>

                <hr>

                <table width="100%">

                    <thead>

                        <tr> 

                            <th>Actor</th>
                            <th>Character</th> 

                        </tr>

                    </thead>

                    <tbody>

                        <% _.each(credits.cast, function(castMember){ %>

                        <tr>
                            <td><%= castMember.name %></h1></td>
                            <td><%= castMember.character %></td>
                        </tr>

                        <% }); %>

                    </tbody>

                </table>

                <h5 class="subheader" id="crew">Crew</h5>

                <hr>

                <table width="100%">

                    <thead>

                        <tr> 

                            <th>Name</th>
                            <th>Department</th> 
                            <th>Job</th>

                        </tr>

                    </thead>

                    <tbody>

                        <% _.each(credits.crew, function(crewMember){ %>

                        <tr>
                            <td><%= crewMember.name %></h1></td>
                            <td><%= crewMember.department %></td>
                            <td><%= crewMember.job %></td>
                        </tr>

                        <% }); %>

                    </tbody>

                </table>

            </div>

        </div>
        <script type="text/javascript">

            document.getElementById('release_date').innerHTML=moment("<%= release_date %>", "YYYY-MM-DD").format('MMMM Do, YYYY');
            document.getElementById('runtime').innerHTML=Math.floor(<%= runtime %> / 60) + " hr " + (<%= runtime %> % 60) + " min";

        </script>
        </script>

    </body>

</html>

